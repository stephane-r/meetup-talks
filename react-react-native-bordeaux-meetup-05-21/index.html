<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
      Des composants React multi-plateformes avec une architecture monorepo
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Partarger plus facilement vos composants React entre diff√©rents packages/plateforme via une architecture monorepo"
    />
    <link
      rel="stylesheet"
      href="node_modules/@shower/ribbon/styles/styles.css"
    />
    <style>
      .shower {
        --slide-ratio: calc(16 / 9);
      }
      .slide.centered {
        padding-bottom: 75px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .slide h2 {
        margin-top: 70px;
      }
      .slide.centered h2 {
        font-size: 70px;
        margin-top: 6px;
        margin-bottom: 6px;
      }
      .slide,
      .slide h2 {
        color: #07244f;
      }
      .slide {
        background: #eef7f1;
        padding-top: 0;
        padding-bottom: 0 !important;
      }
      .slide::after {
        content: none;
      }
      .orange {
        background: #df7f57;
      }
      .orange,
      .orange h2 {
        color: white;
      }
      .progress {
        display: none !important;
      }
      .title-emoji {
        font-size: 35px;
        padding-left: 10px;
      }
      img {
        max-width: 100%;
      }
    </style>
  </head>
  <body class="shower list">
    <header class="caption">
      <h1>Shower Presentation Engine</h1>
      <p>Yours Truly, Famous Inc.</p>
    </header>

    <section class="slide centered orange">
      <h2 style="text-align: center">
        Partager du code entre les projets web et natifs avec React et une
        architecture monorepo
      </h2>
      <p style="margin: 0"><b>React & React-Native Bordeaux Meetup</b></p>
      <p style="font-size: 16px">Mai 2021</p>
    </section>

    <section class="slide grey-light">
      <h2>Qui suis-je <span class="title-emoji">üëã</span></h2>
      <pre>
        <code>&lt;Person</code>
        <code>  fullName="<mark>St√©phane Richin</mark>"</code>
        <code>  age={<mark>29</mark>}</code>
        <code>  city="<mark>Lyon</mark>"</code>
        <code>  company="<mark>Novaway</mark>"</code>
        <code>  role="<mark>Lead front-end developper</mark>"</code>
        <code>/&gt;</code>
      </pre>
    </section>

    <section class="slide centered orange" style="align-items: flex-start">
      <h2>Alors ...</h2>
      <br />
      <h2>multirepo ou monorepo ?</h2>
      <h3>
        Point-virgule ?
        <img
          src="./images/troll.png"
          width="25"
          style="transform: scaleX(-1)"
        />
      </h3>
    </section>

    <section class="slide">
      <h2>
        Les probl√©matiques d'une architecture multirepo
        <span class="title-emoji">üôà</span>
      </h2>
      <ul>
        <li class="next">Plusieurs installations</li>
        <li class="next">Plusieurs maintenances</li>
        <li class="next">
          Plusieurs configurations (linter, CI/CD, .env, etc.)
        </li>
        <li class="next">Potentiellement une grosse perte de temps</li>
      </ul>
    </section>

    <section class="slide">
      <h2>
        Qu'est-ce qu'un monorepo
        <span class="title-emoji">ü§î</span>
      </h2>
      <figure>
        <blockquote>
          <p>
            un monorepo est une strat√©gie de d√©veloppement o√π le code de
            plusieurs projets est stock√© dans un seul et m√™me repository
          </p>
        </blockquote>
        <figcaption>
          Wikipedia <span style="font-style: normal">‚ù§Ô∏è</span>
        </figcaption>
      </figure>
    </section>

    <section class="slide" style="text-align: center">
      <header
        style="display: flex; justify-content: center; align-items: center"
      >
        <h2 style="margin-top: 20px; margin-bottom: 30px; margin-right: 8px">
          Exemple avec
        </h2>
        <img
          src="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fclipground.com%2Fimages%2Freact-logo-png-7.png&f=1&nofb=1"
          alt=""
          width="50"
        />
      </header>
      <img
        src="./images/Screenshot_2021-05-05 facebook react.png"
        alt="Packages React du d√©p√¥t Github de Facebook"
        style="max-width: 80%"
      />
    </section>

    <section class="slide" style="text-align: center">
      <header
        style="display: flex; justify-content: center; align-items: center"
      >
        <h2 style="margin-top: 20px; margin-bottom: 30px; margin-right: 5px">
          Exemple avec
        </h2>
        <img
          src="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fupload.wikimedia.org%2Fwikipedia%2Fcommons%2Fthumb%2F0%2F02%2FBabel_Logo.svg%2F1024px-Babel_Logo.svg.png&f=1&nofb=1"
          alt=""
          width="100"
        />
      </header>
      <img
        src="./images/Screenshot_2021-05-05 babel babel.png"
        alt="Packages Babel du d√©p√¥t Github Babel"
        style="max-width: 80%"
      />
    </section>

    <section class="slide" style="text-align: center">
      <header
        style="display: flex; justify-content: center; align-items: center"
      >
        <h2 style="margin-top: 20px; margin-bottom: 30px; margin-right: 10px">
          Exemple avec
        </h2>
        <img
          src="https://camo.githubusercontent.com/b25f65a5c408dcaeef14b726f979f704a243779bfc87649bf8bb989128306513/68747470733a2f2f7374726170692e696f2f6173736574732f7374726170692d6c6f676f2d6461726b2e737667"
          alt=""
          width="150"
        />
      </header>
      <img
        src="./images/Screenshot_2021-05-18 strapi strapi.png"
        alt="Packages Strapi du d√©p√¥t Github Strapi"
        style="max-width: 80%"
      />
    </section>

    <section class="slide centered orange">
      <h2>Les avantages de ce type d'architecture</h2>
    </section>

    <section class="slide">
      <h2>
        Pourquoi un monorepo ?
        <span class="title-emoji">ü•∞</span>
      </h2>
      <ul>
        <li class="next">Un seul environnement de d√©veloppement</li>
        <li class="next">Une seule structure</li>
        <li class="next">R√©duit la quantit√© de code r√©p√©t√©</li>
        <li class="next">
          Le partage et la r√©utilisation de code sont infiniment plus faciles
        </li>
        <li class="next">
          Le refactoring √† grande √©chelle devient plus simple
        </li>
        <li class="next">
          Pour une stack enti√®rement JavaScript l'avantage est d√©cupl√© : partage
          de code entre le(s) client(s) web/natif et le serveur Node
        </li>
      </ul>
    </section>

    <section class="slide">
      <h2>
        Pourquoi un monorepo ?
        <span class="title-emoji">ü•∞</span>
      </h2>
      <ul>
        <li>
          Partage des configurations des diff√©rents outils (Jest, TypeScript,
          ESLint, Prettier, etc.)
        </li>
        <li class="next">Gestion des d√©pendances plus simple</li>
        <li class="next">Les commits multi-projets</li>
        <li class="next">Une seule review</li>
        <li class="next">Un team work hautement am√©lior√©</li>
      </ul>
    </section>

    <section class="slide centered orange" style="align-items: flex-start">
      <h2>Oh wait ...</h2>
    </section>

    <section class="slide">
      <h2>Quelques points d'attention <span class="title-emoji">üìå</span></h2>
      <ul>
        <li class="next">Le d√©p√¥t peut devenir (tr√®s) gros</li>
        <li class="next">
          L'int√©gration d'un nouveau d√©veloppeur peut √™tre plus difficile
        </li>
        <li class="next">
          Une culture parfois incompatible (par ex. entre les √©quipes clients et
          serveurs)
        </li>
        <li class="next">
          La mise en place d'un CI/CD n‚Äôest pas anodine √† mettre en place
        </li>
        <li class="next">
          Demande d'√™tre plus rigoureux lors des revues de code
        </li>
        <li class="next">
          Potentiellement un probl√®me de s√©curit√© avec l'acc√®s √† toute la
          code-base
        </li>
        <li class="next">Limitations techniques du syst√®me de versionning</li>
      </ul>
    </section>

    <section class="slide centered orange" style="align-items: flex-start">
      <h2>Comment √ßa marche ?</h2>
    </section>

    <section class="slide">
      <h2>Les principaux outils <span class="title-emoji">‚öôÔ∏è</span></h2>
      <ul>
        <li class="next">
          <b>yarn (v1)</b>
          <ul>
            <li>API Workspaces</li>
            <li>
              <em
                >Workspaces are a new way to set up your package
                architecture</em
              >
            </li>
          </ul>
        </li>
        <li class="next">
          <b>lerna</b>
          <ul>
            <li>
              <em
                >A tool for managing JavaScript projects with multiple
                packages</em
              >
            </li>
            <li>
              utilis√© par Facebook (CRA & Jest), Babel, Strapi ou encore
              Cloudflare
            </li>
          </ul>
        </li>
      </ul>
    </section>

    <section class="slide">
      <h2>Les principaux outils <span class="title-emoji">‚öôÔ∏è</span></h2>
      <ul>
        <li>
          <b>pnpm</b>
          <ul>
            <li>
              <em>pnpm has built-in support for monorepositories</em>
            </li>
            <li>
              packages configurable via le fichier <em>pnpm-workspace.yaml</em>
            </li>
          </ul>
        </li>
        <li class="next">
          <b>nx</b>
          <ul>
            <li>
              <em
                >a suite of powerful, extensible dev tools to help you
                architect, test, and build at any scale</em
              >
            </li>
            <li>
              bas√© sur <b>des plugins</b> (@nrwl/angular, @nrwl/node,
              @nrwl/react, etc)
            </li>
          </ul>
        </li>
      </ul>
    </section>

    <section class="slide" style="display: flex; align-items: center">
      <div style="max-width: 30%">
        <img
          src="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fheroku-blog-files.s3.amazonaws.com%2Fposts%2F1488416188-yarn-logo.png&f=1&nofb=1"
          style="max-width: 70%"
          alt=""
        />
        <h2 style="margin-top: 0">Yarn et l'API Workspaces</h2>
      </div>
      <div style="text-align: center">
        <img
          src="https://www.novaway.fr/uploads/media/graph_react_yarn.jpg"
          style="max-width: 90%"
        />
      </div>
    </section>

    <section class="slide">
      <h2>Quelques r√®gles <span class="title-emoji">üöÄ</span></h2>
      <ul>
        <li class="next">
          Un fichier <em>package.json</em> doit √™tre d√©fini √† la racine du
          projet
        </li>
        <li class="next">
          Le <em>package.json</em> devra contenir la cl√© <b>private</b> √†
          <b>true</b> ainsi que les diff√©rents <b>workspaces</b>
        </li>
      </ul>
    </section>

    <section class="slide">
      <h2>Quelques r√®gles <span class="title-emoji">üöÄ</span></h2>
      <pre>
        <code>{</code>
          <code>  "name": "my-app",</code>
          <code>  "private": true,</code>
          <code>  "workspaces": ["packages/admin", "packages/api", ...]</code>
          <code>  // ou "workspaces": ["packages/*"]</code>
        <code>}</code>
      </pre>
    </section>

    <section class="slide">
      <h2>Quelques r√®gles <span class="title-emoji">üöÄ</span></h2>
      <ul>
        <li>
          Chaque <b>package</b> doit contenir √©galement son propre
          <em>package.json</em>
        </li>
        <li class="next">
          Le <em>package.json</em> devra contenir les cl√©s <b>name</b> et
          <b>version</b> afin qu‚Äôil puisse √™tre d√©fini comme module du workspace
        </li>
      </ul>
    </section>

    <section class="slide">
      <h2>Quelques r√®gles <span class="title-emoji">üöÄ</span></h2>
      <pre>
        <code>{</code>
          <code>  "name": "@my-app/ui",</code>
          <code>  "version": "0.0.1",</code>
          <code>  "dependencies": {,</code>
          <code>    "@my-app/core": "0.0.1",</code>
          <code>    ...</code>
          <code>  }</code>
        <code>}</code>
      </pre>
    </section>

    <section class="slide">
      <h2>
        Workspaces : les commandes de base <span class="title-emoji">üöÄ</span>
      </h2>
      <ul>
        <li class="next">
          Lancer un script d'un package :
          <ul>
            <li><b>yarn workspace @my-app/web start</b></li>
          </ul>
        </li>
        <li class="next">
          Ajouter ou supprimer une d√©pendence a un package :
          <ul>
            <li><b>yarn workspace @my-app/web add/remove react-native</b></li>
          </ul>
        </li>
        <li class="next">
          Ajouter ou supprimer une d√©pendence global au workspace :
          <ul>
            <li><b>yarn add/remove react-native -W</b></li>
          </ul>
        </li>
        <li class="next">
          Il est possible de cr√©er un script npm depuis le package.json du
          workspace
          <ul>
            <li><b>yarn web:start => yarn workspace @my-app/web start</b></li>
          </ul>
        </li>
      </ul>
    </section>

    <section
      class="slide centered"
      style="flex-direction: row; justify-content: space-between"
    >
      <h2>React et monorepo <span class="title-emoji">üòè</span></h2>
      <div style="text-align: center">
        <img
          src="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fclipground.com%2Fimages%2Freact-logo-png-7.png&f=1&nofb=1"
          alt="Logo React"
          style="max-width: 80%"
        />
      </div>
    </section>

    <section class="slide">
      <h2>React et le multi-plateforme <span class="title-emoji">üöÄ</span></h2>
      <p>
        Dans le cadre d'une application React, une architecture
        <b>monorepo</b> va permettre de partager et de maintenir plus facilement
        les <b>composants</b> (ainsi que les <b>hooks</b>, le
        <b>state management</b> ou encore <b>le routing</b>) entre les
        diff√©rents packages
      </p>
    </section>

    <section class="slide">
      <header
        style="display: flex; justify-content: center; align-items: center"
      >
        <h2 style="margin-top: 20px; margin-bottom: 30px; margin-right: 5px">
          Exemple avec l'application <a href="https://devhubapp.com/">devhub</a>
        </h2>
      </header>
      <p style="text-align: center">
        <img
          src="https://devhubapp.com/static/screenshots/dark/devhub-cross-platform.jpg"
          alt="Packages Babel du d√©p√¥t Github Babel"
          style="max-width: 85%"
        />
      </p>
    </section>

    <section class="slide centered orange" style="align-items: flex-start">
      <h2>
        Une API commune entre <br />
        natif et web gr√¢ce √† <br />
        react-native-web
        <span style="font-size: 0.8em; display: inline-block">üíñ</span>
      </h2>
    </section>

    <section class="slide">
      <a href="https://github.com/necolas/react-native-web"
        ><h2>react-native-web</h2></a
      >
      <p>
        D√©velopp√©e par Nicolas Gallagher, cette librairie permet d'utiliser les
        API de <b>react-native</b> ... en web üî•
      </p>
      <p class="next">
        <img
          src="./images/carbon.png"
          alt="Exemple de code avec la librairie react-native-web"
          width="400"
        />
      </p>
    </section>

    <section class="slide centered orange" style="align-items: flex-start">
      <h2>
        Du partage sur <br />
        Windows, macOS et <br />
        ... console
        <span style="font-size: 0.8em; display: inline-block">ü§Ø</span>
      </h2>
    </section>

    <section class="slide">
      <h2>react-native-windows <span class="title-emoji">üò≤</span></h2>
      <p style="text-align: center">
        <img
          src="https://microsoft.github.io/react-native-windows/img/homepage/cross-platform.png"
          width="80%"
        />
      </p>
    </section>

    <section class="slide">
      <h2>React Native for Windows + macOS</h2>
      <div style="display: flex">
        <p style="flex: 0 0 50%; padding-right: 10px">
          Microsoft maintient tr√®s tr√®s activement le portage de
          <b>react-native</b>
          sur Windows et macOS
        </p>
        <p style="flex: 0 0 50%">
          <img
            src="https://microsoft.github.io/react-native-windows/img/homepage/native_and_js_windows_cropped.png"
            style="max-width: 500px"
          />
        </p>
      </div>
    </section>

    <section class="slide">
      <h2>Exemple d'architecture <span class="title-emoji">ü•∞</span></h2>
      <div
        style="
          display: flex;
          justify-content: space-around;
          align-items: center;
        "
      >
        <pre>
          <code>- <mark>packages</mark></code>
            <code>  - mobile</code>
            <code>  - storybook</code>
            <code>  - ui</code>
            <code>  - web</code>
            <code>  ...</code>
        </pre>
        <span>=></span>
        <span>
          <img
            src="https://www.novaway.fr/uploads/media/pasted%20image%200.png"
            alt=""
            style="max-height: 350px"
          />
        </span>
      </div>
    </section>

    <section class="slide">
      <h2>Pour r√©sum√©, une application React</h2>
      <ul>
        <li class="next">
          du web avec <a href="">react-dom</a> et
          <a href="react-native-web">react-native-web</a>
        </li>
        <li class="next">
          du mobile et tablette avec <a href="">react-native</a>
        </li>
        <li class="next">
          du desktop avec <a href="">react-native-windows</a>
        </li>
      </ul>
    </section>

    <section class="slide centered orange" style="align-items: flex-start">
      <h2>
        Une petite d√©mo ?
        <span style="font-size: 0.8em; display: inline-block">üòè</span>
      </h2>
    </section>

    <section class="slide">
      <h2>Librairies multi-plateforme <span class="title-emoji">ü•∞</span></h2>
      <ul>
        <li>
          <a href="https://github.com/react-native-video/react-native-video"
            >react-native-video</a
          >
          : web, iOS, Android et Windows
        </li>
        <li>
          <a href="https://github.com/oblador/react-native-vector-icons"
            >react-native-vector-icons</a
          >
          : web, iOS, Android, Windows et macOS
        </li>
        <li>
          <a href="https://callstack.github.io/react-native-paper/index.html"
            >react-native-paper</a
          >
          : web, iOS et Android
        </li>
        <li>
          <a href="https://reactnavigation.org/">react-navigation</a> : web, iOS
          et Android
        </li>
        <li>
          <a href="https://react-hook-form.com/">React Hook Form</a> : web, iOS
          et Android
        </li>
        <li>Et beaucoup, beaucoup d'autres ! (pensez aux awesome list)</li>
      </ul>
    </section>

    <section class="slide">
      <h2>
        Quelques ressources sur le sujet <span class="title-emoji">üìñ</span>
      </h2>
      <ul>
        <li>
          <a
            href="https://dev.to/brunolemos/tutorial-100-code-sharing-between-ios-android--web-using-react-native-web-andmonorepo-4pej"
            >How to share code between iOS, Android & Web using React Native,
            react-native-web and monorepo</a
          >
        </li>
        <li>
          <a
            href="https://moduscreate.com/blog/setting-up-a-monorepo-react-app-with-yarn/"
            >Setting Up A Monorepo React App with Yarn</a
          >
        </li>
        <li>
          <a
            href="https://medium.com/@luisvieira_gmr/building-large-scale-react-applications-in-a-monorepo-91cd4637c131"
            >Building large scale react applications in a monorepo</a
          >
        </li>
        <li>
          <a
            href="https://www.windowscentral.com/xbox-app-pc-gets-speed-boost-ditching-electron-react-native-uwp"
            >Xbox app for PC gets speed boost, ditching Electron for React
            Native UWP</a
          >
        </li>
        <li>
          <a href="https://www.youtube.com/watch?v=Pkf9H3XEMoE"
            >React in Battlefield 1 by Markus Thurlin (@truppo) at @ReactEurope
            2018
          </a>
        </li>
        <li>
          <a href="https://www.novaway.fr/blog/tech/creer-monorepo-avec-react"
            >Cr√©er un monorepo avec React üá®üáµ</a
          >
        </li>
        <li>
          <a
            href="https://medium.com/@simonpeyou/de-lint%C3%A9r%C3%AAt-et-l-usage-d-un-mono-repository-dans-une-startup-fd461bb1760d"
            >De l‚Äôint√©r√™t et l‚Äôusage d‚Äôun mono-repository üá®üáµ</a
          >
        </li>
      </ul>
    </section>

    <section class="slide centered">
      <h2>Merci <span class="title-emojii">ü§ó</span></h2>
    </section>

    <footer class="badge">
      <a href="https://github.com/shower/shower">Fork me on GitHub</a>
    </footer>

    <div class="progress"></div>

    <script src="node_modules/@shower/core/dist/shower.js"></script>
    <!-- Copyright ¬© 2021 Yours Truly, Famous Inc. -->
  </body>
</html>
